namespace = cvlm_establish

# cvlm_establish.5: ??? - tbd
# cvlm_establish.10: Royalty for Loyalty
# cvlm_establish.15: Servants of Servants
# cvlm_establish.20: The Manner of a Host
# cvlm_establish.25: Fighting the Landlords
# cvlm_establish.30: In the Name of Faith
# cvlm_establish.35: Sound of Progress
# cvlm_establish.100: Simmering Conflict
# cvlm_establish.101: Simmering Conflict - Port
# cvlm_establish.105: Simmering Conflict - Prince of Terror
# cvlm_establish.110: Simmering Conflict - Illusive Gentleman
# cvlm_establish.115: Simmering Conflict - Smooth-Talking Charmer
# cvlm_establish.120: Simmering Conflict - Unpopular Figurehead
# cvlm_establish.200: The Rightful Governor
# cvlm_establish.201: The Rightful Governor - hidden
# cvlm_establish.205: There can be only one


# Royalty for Loyalty
cvlm_establish.10 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.10.t
	desc = cvlm_establish.10.d
	flavor = cvlm_establish.10.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	event_image = {
		video = "africa_diplomats_negotiating"
	}

	icon = "gfx/interface/icons/lens_toolbar_icons/overlord.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
	    scope:colonial_subject = {
	        ruler = { save_scope_as = colonial_subject_ruler }
	    }
	}

	option = {
		name = cvlm_establish.10.1
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = { 
            scope:colonial_subject = { 
                OR = {
                    is_subject_type = subject_type_protectorate
                    is_subject_type = subject_type_puppet
                }
            } 
        }
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = {
		        text = cvlm_establish.10.1.tooltip.flatterer
                set_variable = {
			        name = cvlm_establish_option_monarchy_var
			        value = 2
		        }
		    }
		}
		else = {
            custom_tooltip = {
		        text = cvlm_establish.10.1.tooltip
                set_variable = {
			        name = cvlm_establish_option_monarchy_var
			        value = 2
		        }
		    }
		}
        cvlm_establish_tolerance_increase = yes
		scope:colonial_subject = {
		    add_loyalists = {
			    value = large_radicals
			    pop_type = aristocrats
		    }
		}
        ai_chance = {
			base = 0
		}
   	}

	option = {
		name = cvlm_establish.10.2
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = { 
            scope:colonial_subject = { 
                OR = {
                    is_subject_type = subject_type_protectorate
                    is_subject_type = subject_type_puppet
                }
            } 
        }
        custom_tooltip = {
		    text = cvlm_establish.10.2.tooltip
            set_variable = {
			    name = cvlm_establish_option_monarchy_var
			    value = 1
		    }
		}
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_monarchy
                }
                add = 25
            }
            modifier = {
                trigger = {
                    AND = {
                        has_law = law_type:law_monarchy
                        scope:colonial_subject.ruler = { is_historical = yes }
                    }
                }
                add = 25
            }
		}
   	}
    
	option = {
		name = cvlm_establish.10.3
		if = {
	        limit = { scope:colonial_subject = { is_subject_type = subject_type_puppet } }
            custom_tooltip = {
                text = cvlm_establish.10.3.tooltip.a
                set_variable = {
                    name = cvlm_establish_option_monarchy_var
                    value = -1
                }
            }
            cvlm_establish_tolerance_decrease = yes
		    scope:colonial_subject = {
		        add_radicals = {
			        value = medium_radicals
			        pop_type = aristocrats
		        }
		    }
		}
		else = {
            custom_tooltip = {
                text = cvlm_establish.10.3.tooltip.b
                set_variable = {
                    name = cvlm_establish_option_monarchy_var
                    value = -1
                }
            }
            cvlm_establish_tolerance_decrease_violently = yes
		    scope:colonial_subject = {
		        add_radicals = {
			        value = large_radicals
			        pop_type = aristocrats
		        }
		    }
		}
		ai_chance = {
			base = 25
		}
		default_option = yes
   	}

    #DEPRECIATED
	#option = {
	#	name = cvlm_establish.10.4
	#	highlighted_option = yes
	#	show_as_unavailable = { always = yes }
	#	trigger = {
    #        scope:colonial_subject = { ig:ig_landowners = { is_powerful = no } }
    #        custom_tooltip = {
    #            text = colonial_government_WIP
    #            always = no
    #        }
    #    }
    #    custom_tooltip = {
    #        text = cvlm_establish.10.4.tooltip
    #        set_variable = {
    #            name = cvlm_establish_option_monarchy_var
    #            value = -2
    #        }
    #    }
    #    cvlm_establish_tolerance_increase = yes
	#	scope:colonial_subject = {
	#	    add_loyalists = {
	#		    value = large_radicals
	#		    pop_type = aristocrats
	#	    }
	#	}
    #}
}

# Servants of Servants
cvlm_establish.15 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.15.t
	desc = cvlm_establish.15.d
	flavor = cvlm_establish.15.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    event_image = {
		video = "africa_leader_arguing"
	}

    icon = "gfx/interface/icons/event_icons/event_scales.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        scope:colonial_subject = {
            ig:ig_landowners = { save_scope_as = colonial_subject_landowners_ig }
            ig:ig_intelligentsia = { save_scope_as = colonial_subject_ig_intelligentsia_ig }
        }
	}

    # appointment
    option = {
        name = cvlm_establish.15.1
        custom_tooltip = {
            text = cvlm_establish.15.1.tooltip
            set_variable = {
                name = cvlm_establish_option_bureaucracy_var
                value = 1
            }
        }
        if = {
            limit = { scope:colonial_subject = { has_law = law_type:law_appointed_bureaucrats } }
            cvlm_establish_tolerance_increase = yes
            scope:colonial_subject = {
                add_liberty_desire = -10
                add_loyalists = {
                    value = medium_radicals
                    pop_type = bureaucrats
                }
            }
        }
        else = {
            cvlm_establish_tolerance_decrease = yes
            scope:colonial_subject = {
                add_liberty_desire = 10
                add_loyalists = {
                    value = medium_radicals
                    pop_type = bureaucrats
                }
                add_radicals = {
                    value = medium_radicals
                    pop_type = aristocrats
                }
            }
        }
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    scope:colonial_subject = { has_law = law_type:law_appointed_bureaucrats }
                }
                add = 100
            }
		}
        default_option = yes
    }

    # hereditary
    option = {
        name = cvlm_establish.15.2
        custom_tooltip = {
            text = cvlm_establish.15.2.tooltip
            set_variable = {
                name = cvlm_establish_option_bureaucracy_var
                value = -1
            }
        }
        if = {
            limit = { scope:colonial_subject = { has_law = law_type:law_hereditary_bureaucrats } }
            cvlm_establish_tolerance_increase = yes
            scope:colonial_subject = {
                add_liberty_desire = -10
                add_loyalists = {
                    value = medium_radicals
                    pop_type = aristocrats
                }
            }
        }
        else = {
            cvlm_establish_tolerance_decrease = yes
            scope:colonial_subject = {
                add_liberty_desire = 10
                add_loyalists = {
                    value = medium_radicals
                    pop_type = aristocrats
                }
                add_radicals = {
                    value = medium_radicals
                    pop_type = bureaucrats 
                }
            }
        }
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    scope:colonial_subject = { has_law = law_type:law_hereditary_bureaucrats }
                }
                add = 100
            }
		}
    }
}

# The Manner of a Host
cvlm_establish.20 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_suzerain
	duration = 2

	title = cvlm_establish.20.t
	desc = cvlm_establish.20.d
	flavor = cvlm_establish.20.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    event_image = {
		video = "europenorthamerica_capitalists_meeting"
	}

	icon = "gfx/interface/icons/sol_icons/secure.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        scope:colonial_suzerain = { ordered_primary_culture = { save_scope_as = colonial_suzerain_culture } }
	}

	option = {
		name = cvlm_establish.20.1
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = {
		        text = cvlm_establish.20.1.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_culture_var
                    value = 1
                }
		    }
		}
		else = {
            custom_tooltip = {
		        text = cvlm_establish.20.1.tooltip
                set_variable = {
                    name = cvlm_establish_option_culture_var
                    value = 1
                }
		    }
	    }
		ai_chance = {
			base = 100
		}
        default_option = yes
   	}

	option = {
		name = cvlm_establish.20.2
        highlighted_option = yes
		show_as_unavailable = { always = yes }
        trigger = {
            custom_tooltip = {
                text = cvlm_establish.20.2.tooltip.trigger
                trigger_if = {
                    limit = { exists = var:cvlm_establish_option_monarchy_var }
                    OR = {
                        var:cvlm_establish_option_monarchy_var = -1
                        NOT = { scope:colonial_subject = { has_law = law_type:law_monarchy } }
                    }
                }
                trigger_else = {
                    NOT = { scope:colonial_subject = { has_law = law_type:law_monarchy } }
                }
                scope:colonial_suzerain_culture = {
                    NOT = { is_primary_culture_of = scope:colonial_subject }
                }
            }
		}
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = {
		        text = cvlm_establish.20.2.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_culture_var
                    value = -1
                }
		    }
		}
		else = {
            custom_tooltip = {
		        text = cvlm_establish.20.2.tooltip
                set_variable = {
                    name = cvlm_establish_option_culture_var
                    value = -1
                }
		    }
		}
		ai_chance = {
			base = 0
		}
        cvlm_establish_tolerance_decrease_violently = yes
   	}
}

# Fighting the Landlords
cvlm_establish.25 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.25.t
	desc = cvlm_establish.25.d
	flavor = cvlm_establish.25.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    event_image = {
		video = "africa_prosperous_farm"
	}

    icon = "gfx/interface/icons/event_icons/event_protest.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        scope:colonial_subject = {
            ig:ig_landowners = { save_scope_as = colonial_subject_landowners_ig }
            ig:ig_rural_folk = { save_scope_as = colonial_subject_ruralfolk_ig }
        }
	}

    # tenant farmers
    option = {
        name = cvlm_establish.25.1
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            scope:colonial_subject = { has_law = law_type:law_serfdom }
        }
        custom_tooltip = {
            text = cvlm_establish.25.1.tooltip
            set_variable = {
                name = cvlm_establish_option_land_var
                value = 1
            }
        }
        # farmers are happy, old moneys are mad
        cvlm_establish_tolerance_increase = yes
        scope:colonial_subject = { 
            add_liberty_desire = 5
            add_radicals = {
                value = medium_radicals
                pop_type = aristocrats
            }
        }
        scope:anti_overlord_lobby = { change_appeasement = { amount = -1 factor = appeasement_lobby_loss } }
		ai_chance = {
			base = 10
		}
    }

    # homesteading
    option = {
        name = cvlm_establish.25.2
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            scope:colonial_subject = { 
                OR = {
                    has_law = law_type:law_serfdom 
                    has_law = law_type:law_tenant_farmers
                }
            }
        }
        custom_tooltip = {
            text = cvlm_establish.25.2.tooltip
            set_variable = {
                name = cvlm_establish_option_land_var
                value = 2
            }
        }
        # tolerance change based on law
        if = {
            limit = { scope:colonial_subject = { has_law = law_type:law_serfdom } }
            cvlm_establish_tolerance_increase = yes
            scope:colonial_subject = { 
                add_liberty_desire = 10 
                add_radicals = {
			        value = large_radicals
			        pop_type = aristocrats
		        }
            }
            scope:anti_overlord_lobby = { change_appeasement = { amount = -2 factor = appeasement_lobby_loss } }
        }
        else = {
            cvlm_establish_tolerance_increase = yes
            scope:colonial_subject = { 
                add_liberty_desire = 5
                add_radicals = {
			        value = medium_radicals
			        pop_type = aristocrats
		        }
            }
            scope:anti_overlord_lobby = { change_appeasement = { amount = -1 factor = appeasement_lobby_loss } }
        }
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_homesteading 
                }
                add = 100
            }
		}
    }

    # commercialized
    option = {
        name = cvlm_establish.25.3
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            scope:colonial_suzerain = { has_law = law_type:law_commercialized_agriculture }
            NOT = { scope:colonial_subject = { has_law = law_type:law_commercialized_agriculture } }
        }
        custom_tooltip = {
            text = cvlm_establish.25.3.tooltip
            set_variable = {
                name = cvlm_establish_option_land_var
                value = 3
            }
        }
        # tolerance change based on law
        if = {
            # that's still better than serfdom
            limit = { scope:colonial_subject = { has_law = law_type:law_serfdom } }
            cvlm_establish_tolerance_increase = yes
            scope:colonial_subject = { 
                add_liberty_desire = 5
                add_radicals = {
			        value = medium_radicals
			        pop_type = aristocrats
		        }
            }
            scope:anti_overlord_lobby = { change_appeasement = { amount = -1 factor = appeasement_lobby_loss } }
        }
        else_if = {
            limit = { scope:colonial_subject = { has_law = law_type:law_tenant_farmers  } }  
            scope:colonial_subject = { 
                add_radicals = {
			        value = small_radicals
			        pop_type = aristocrats
		        }
            } 
        }
        else = {
        }
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_commercialized_agriculture 
                }
                add = 100
            }
		}
    }

    # nothing
    option = {
        name = cvlm_establish.25.4
        default_option = yes
        hidden_effect = {
            set_variable = {
                name = cvlm_establish_option_land_var
                value = -1
            }
        }
        scope:colonial_subject = { 
            add_liberty_desire = -10 
            add_loyalists = {
                value = medium_radicals
                pop_type = aristocrats
            }
        }
        scope:anti_overlord_lobby = { change_appeasement = { amount = 1 factor = appeasement_lobby_gain } }
        ai_chance = {
            base = 10
        }
    }
}

    

# In the Name of Faith
cvlm_establish.30 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_suzerain
	duration = 2

	title = cvlm_establish.30.t
	desc = cvlm_establish.30.d
	flavor = cvlm_establish.30.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/southamerica/christianity"

    # jewish
	event_image = {
		trigger = {
			religion = rel:jewish
		}
		video = "europenorthamerica_judaism"
	}
    # hindu / sikh
	event_image = {
		trigger = {
			OR = {
				religion = rel:hindu
				religion = rel:sikh
			}
		}
		video = "asia_hinduism_sikhism"
	}
    # shinto / confucian
	event_image = {
		trigger = {
			OR = {
				religion = rel:shinto
				religion = rel:confucian
			}
		}
		video = "asia_confucianism_shinto"
	}
    # buddhism
	event_image = {
		trigger = {
			OR = {
				religion = rel:mahayana
				religion = rel:gelugpa
				religion = rel:theravada
			}
		}
		video = "asia_buddhism"
	}
    # islam
	event_image = {
		trigger = {
			OR = {
				religion = rel:sunni
				religion = rel:shiite
			}
		}
		video = "middleeast_islam"
	}
    # animist
	event_image = {
		trigger = {
            religion = rel:animist
		}
		video = "africa_animism"
	}
    # default - christian
    event_image = {
		video = "southamerica_christianity"
	}

	icon = "gfx/interface/icons/generic_icons/conversion.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        scope:colonial_suzerain = {
            religion = { save_scope_as = colonial_suzerain_religion }
            ig:ig_devout = { save_scope_as = colonial_suzerain_religion_ig }
        }
        scope:colonial_subject = {
            religion = { save_scope_as = colonial_subject_religion }
            ig:ig_devout = { save_scope_as = colonial_subject_religion_ig }
        }
	}

    # enforce, state religion
	option = {
		name = cvlm_establish.30.1
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            NOR = {
                has_law = law_type:law_total_separation
                has_law = law_type:law_state_atheism
            }
        }
        scope:anti_overlord_lobby = { add_lobby_member = scope:colonial_subject_religion_ig }
        custom_tooltip = {
            text = cvlm_establish.30.1.tooltip
            set_variable = {
                name = cvlm_establish_option_religion_var
                value = 2
            }
        }
        cvlm_establish_tolerance_decrease_violently = yes
		scope:colonial_subject = {
		    add_radicals = {
			    value = large_radicals
			    pop_type = clergymen
		    }
		}
		scope:colonial_suzerain = {
            ig:ig_devout = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased_more
				    months = normal_modifier_time
			    }
		    }
            ig:ig_intelligentsia = {
			    add_modifier = {
				    name = cvlm_modifier_ig_angered
				    months = normal_modifier_time
			    }
		    }
		}
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_state_religion
                }
                add = 100
            }
		}
   	}

    # enforce, moderate
	option = {
		name = cvlm_establish.30.2
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            NOT = {
                has_law = law_type:law_state_atheism
            }
        }
        scope:anti_overlord_lobby = { add_lobby_member = scope:colonial_subject_religion_ig }
        custom_tooltip = {
            text = cvlm_establish.30.2.tooltip
            set_variable = {
                name = cvlm_establish_option_religion_var
                value = 1
            }
        }
        cvlm_establish_tolerance_decrease = yes
		scope:colonial_subject = {
		    add_radicals = {
			    value = medium_radicals
			    pop_type = clergymen
		    }
		}
		scope:colonial_suzerain = {
            ig:ig_devout = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = normal_modifier_time
			    }
		    }
            ig:ig_intelligentsia = {
			    add_modifier = {
				    name = cvlm_modifier_ig_angered_less
				    months = normal_modifier_time
			    }
		    }
		}
		ai_chance = {
			base = 50
		}
		default_option = yes
   	}

    # non-intervention
	option = {
		name = cvlm_establish.30.3
	    highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            NOT = { has_law = law_type:law_theocracy }
            custom_tooltip = {
                text = cvlm_establish.20.2.outcome.trigger
                trigger_if = {
                    limit = { exists = var:cvlm_establish_option_culture_var }
                    NOT = { var:cvlm_establish_option_culture_var = -1 }
                }
            }
        }
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = {
		        text = cvlm_establish.30.3.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_religion_var
                    value = -1
                }
		    }
		}
		else = {
            custom_tooltip = {
		        text = cvlm_establish.30.3.tooltip
                set_variable = {
                    name = cvlm_establish_option_religion_var
                    value = -1
                }
		    }
		}
        cvlm_establish_tolerance_increase = yes
		scope:colonial_subject = {
		    add_loyalists = {
			    value = large_radicals
			    pop_type = clergymen
		    }
		}
		scope:colonial_suzerain = {
            ig:ig_intelligentsia = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased_less
				    months = normal_modifier_time
			    }
		    }
            ig:ig_devout = {
			    add_modifier = {
				    name = cvlm_modifier_ig_angered
				    months = normal_modifier_time
			    }
		    }
		}
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_total_separation 
                }
                add = 50
            }
		}
   	}

    # total separation or state atheism
	option = {
		name = cvlm_establish.30.4
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            custom_tooltip = {
                text = cvlm_establish.30.4.trigger
                OR = {
                    AND = {
                        scope:colonial_suzerain = {
                            has_law = law_type:law_state_atheism
                        }
                        scope:colonial_subject = {
                            NOT = { has_law = law_type:law_state_atheism }
                        }
                    }
                    AND = {
                        scope:colonial_suzerain = {
                            has_law = law_type:law_total_separation
                        }
                        scope:colonial_subject = {
                            NOR = {
                                has_law = law_type:law_total_separation
                                has_law = law_type:law_state_atheism
                            }
                        }
                    }
                }
            }
        }
        if = {
            limit = { scope:colonial_subject = { has_law = law_type:law_state_religion } }
            custom_tooltip = {
                text = cvlm_establish.30.4.tooltip.a
                set_variable = {
                    name = cvlm_establish_option_religion_var
                    value = -2
                }
            }
            cvlm_establish_tolerance_decrease_violently = yes
            scope:colonial_subject = {
                add_radicals = {
                    value = large_radicals
                    pop_type = clergymen
                }
            }
        }
        else = {
            custom_tooltip = {
                text = cvlm_establish.30.4.tooltip.b
                set_variable = {
                    name = cvlm_establish_option_religion_var
                    value = -2
                }
            }
            cvlm_establish_tolerance_decrease = yes
            scope:colonial_subject = {
                add_radicals = {
                    value = medium_radicals
                    pop_type = clergymen
                }
            }
        }
		scope:colonial_suzerain = {
            ig:ig_intelligentsia = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = normal_modifier_time
			    }
		    }
            ig:ig_devout = {
			    add_modifier = {
				    name = cvlm_modifier_ig_angered_more
				    months = normal_modifier_time
			    }
		    }
		}
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_total_separation 
                }
                add = 50
            }
            modifier = {
                trigger = {
                    has_law = law_type:law_state_atheism 
                }
                add = 10000
            }
		}
   	}
}

# Sound of Progress
cvlm_establish.35 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_suzerain
	duration = 2

	title = cvlm_establish.35.t
	desc = cvlm_establish.35.d
	flavor = cvlm_establish.35.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
    event_image = {
		video = "unspecific_gears_pistons"
	}

    icon = "gfx/interface/icons/event_icons/event_industry.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
	}

    # interventionism
    option = {
        name = cvlm_establish.35.1
        custom_tooltip = {
            text = cvlm_establish.35.1.tooltip
            set_variable = {
                name = cvlm_establish_option_economy_var
                value = 1
            }
        }
		ai_chance = {
			base = 10
		}
    }

    # extraction economy 
    option = {
        name = cvlm_establish.35.2
        custom_tooltip = {
            text = cvlm_establish.35.2.tooltip
            set_variable = {
                name = cvlm_establish_option_economy_var
                value = 2
            }
        }
		ai_chance = {
			base = 0
            modifier = {
                trigger = {
                    has_law = law_type:law_colonial_exploitation 
                }
                add = 20
            }
		}
        default_option = yes
    }

    # agrarianism
    option = {
        name = cvlm_establish.35.3
        custom_tooltip = {
            text = cvlm_establish.35.3.tooltip
            set_variable = {
                name = cvlm_establish_option_economy_var
                value = -1
            }
        }
		ai_chance = {
			base = 5
		}
    }

    # industry banned
    option = {
        name = cvlm_establish.35.4
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
		    has_technology_researched = romanticism
        }
        custom_tooltip = {
            text = cvlm_establish.35.4.tooltip
            set_variable = {
                name = cvlm_establish_option_economy_var
                value = -2
            }
        }
		ai_chance = {
			base = 0
		}
    }
}

# Simmering Conflict
cvlm_establish.100 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.100.t
	desc = cvlm_establish.100.d
	flavor = cvlm_establish.100.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	event_image = {
		video = "votp_conspiring"
	}

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

    immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        scope:colonial_subject.capital.region = { save_scope_as = colonial_subject_region }  
    }

	option = {
		name = cvlm_establish.100.1
        default_option = yes
        cvlm_establish_tolerance_increase = yes
        add_modifier = {
			name = cvlm_modifier_country_placate_resistence
			months = short_modifier_time
			multiplier = money_amount_multiplier_small
		}
		ai_chance = {
			base = 10
		}
   	}

   	option = {
		name = cvlm_establish.100.2
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
		    has_law = law_type:law_secret_police
            institution_investment_level = { institution = institution_home_affairs value >= 3 }
            NOT = {
                any_civil_war = {
                    civil_war_progress > 0
                }
            }
        }
        add_modifier = {
			name = cvlm_modifier_country_overseas_mission
			months = short_modifier_time
		}
		ai_chance = {
			base = 20
		}
		cvlm_establish_tolerance_increase = yes
   	}

	option = {
		name = cvlm_establish.100.3
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = {
            scope:colonial_suzerain = { is_at_war = no }
            scope:colonial_subject = { is_at_war = no }
        }
        custom_tooltip = {
            text = cvlm_establish.100.3.tooltip
            trigger_event = { id = cvlm_establish.101 months = 3 }
        }
		ai_chance = {
			base = 0
		}
   	}

	option = {
		name = cvlm_establish.100.4
		highlighted_option = yes
		show_as_unavailable = { always = yes }
		trigger = { NOT = { scope:colonial_subject = { is_owed_obligation_by = scope:colonial_suzerain } } }
        if = {
            limit = { scope:colonial_subject = { owes_obligation_to = scope:colonial_suzerain } }
            scope:colonial_subject = {
                set_owes_obligation_to = {
                    country = scope:colonial_suzerain
                    setting = no
                }
            }
        }
        else = {
            scope:colonial_suzerain = {
                set_owes_obligation_to = {
                    country = scope:colonial_subject
                    setting = yes
                }
            }
        }
        random_list = {
            30 = { cvlm_establish_tolerance_increase = yes }
            40 = { }
            30 = { cvlm_establish_tolerance_decrease = yes }
    	}
		ai_chance = {
			base = 0
		}
   	}

	option = {
		name = cvlm_establish.100.5
        random_list = {
            40 = { }
            60 = { cvlm_establish_tolerance_decrease = yes }
    	}
		ai_chance = {
			base = 0
		}
   	}
}

# Simmering Conflict - Port
cvlm_establish.101 = {
	type = country_event
    hidden = yes

    immediate = {
        random_list = {
            25 = { trigger_event = { id = cvlm_establish.105 } }
            25 = { trigger_event = { id = cvlm_establish.110 } }
            25 = { trigger_event = { id = cvlm_establish.115 } }
            25 = { trigger_event = { id = cvlm_establish.120 } }
        }
    }
}

# Simmering Conflict - Prince of Terror
cvlm_establish.105 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.105.t
	desc = cvlm_establish.105.d
	flavor = cvlm_establish.105.f

	gui_window = event_window_1char_propaganda

	left_icon = scope:colonial_garrison_officer

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_military.dds"

    immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        # create_character
        scope:colonial_subject = {
            scope:colonial_suzerain = { ordered_primary_culture = { save_temporary_scope_as = colonial_suzerain_culture } }
            create_character = {
                template = cvlm_prince_of_terror
                culture = scope:colonial_suzerain_culture
                interest_group = ig_armed_forces
                save_scope_as = colonial_garrison_officer
            }
        }
        # get primary ig of the anti-overlord lobby
        scope:colonial_subject = {
            ordered_interest_group = {
                limit = { 
                    any_political_lobby = {
                        OR = {
                            is_political_lobby_type = lobby_anti_overlord
                            is_political_lobby_type = lobby_anti_country
                        }
                        target = { scope:colonial_suzerain ?= THIS }
                    }
                }
                order_by = ig_clout
                save_scope_as = anti_overlord_ig
            }
        }
        # calculate how many pops is "lost", no more than 5000
        # root = {
        #     if = {
        #         limit = { scope:colonial_subject.capital.state_population > 500000 }
        #         set_variable = { name = pop_lost_many value = yes }
        #     }
        #     else = {
        #         set_variable = { name = pop_lost_many value = no }
        #     }
        # }
    }

	option = {
		name = cvlm_establish.105.1
        # go home / removed 
        scope:colonial_garrison_officer = {
            hidden_effect = { free_character_from_void = yes }
			cvlm_suzerain_recall_character_effect = yes
		}
        # incident
        create_incident = {
			country = scope:colonial_subject
			value = 10
		} 
        # suzerain: loyalists / radicals, ig approval
		scope:colonial_suzerain = {
            add_loyalists = {
			    value = small_radicals
			    pop_type = officers
		    }
		    # pleased
            every_interest_group = {
                limit = { cvlm_is_pro_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = short_modifier_time
                }
            }
            # angered
            every_interest_group = {
                limit = { cvlm_is_anti_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_angered
				    months = short_modifier_time
                }
            }
		}
        # subject: modifiers, liberty desire, lobby appeasement
        scope:colonial_subject = { 
            add_liberty_desire = 10
		}
        scope:anti_overlord_lobby = { 
            change_appeasement = { amount = -3 factor = appeasement_lobby_loss } 
            every_lobby_member = {
                add_modifier = {
                    name = cvlm_modifier_ig_bloody_suppression
                    months = short_modifier_time
                }
            }
        }
        # lost population
        scope:colonial_subject.capital = {
            kill_population_percent_in_state = { percent = 0.001 interest_group = scope:anti_overlord_ig }
		}
   	}

    option = {
		name = cvlm_establish.105.2
        default_option = yes
        # go home / removed 
        scope:colonial_garrison_officer = { 
            hidden_effect = { kill_character = { value = yes hidden = yes } }
        }
        # incident
        create_incident = {
			country = scope:colonial_subject
			value = 5
		} 
        # suzerain: loyalists / radicals, ig approval
		scope:colonial_suzerain = {
            add_radicals = {
			    value = medium_radicals
			    pop_type = officers
		    }
		    # pleased
            every_interest_group = {
                limit = { cvlm_is_anti_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = short_modifier_time
                }
            }
            # angered
            every_interest_group = {
                limit = { cvlm_is_pro_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_angered
				    months = short_modifier_time
                }
            }
		}
        # subject: modifiers, liberty desire, lobby appeasement
        scope:colonial_subject = { 
            add_liberty_desire = 5
		}
        scope:anti_overlord_lobby = { 
            change_appeasement = { amount = -1 factor = appeasement_lobby_loss } 
            every_lobby_member = {
                add_modifier = {
                    name = cvlm_modifier_ig_bloody_suppression
                    months = short_modifier_time
                }
            }
        }
        # lost population
        scope:colonial_subject.capital = {
            kill_population_percent_in_state = { percent = 0.001 interest_group = scope:anti_overlord_ig }
		}
   	}

    option = {
		name = cvlm_establish.105.3
        # go home / removed 
        scope:colonial_garrison_officer = { 
            hidden_effect = { kill_character = { value = yes hidden = yes } }
        }
        # incident
        create_incident = {
			country = scope:colonial_subject
			value = 5
		} 
        # suzerain: loyalists / radicals, ig approval
		scope:colonial_suzerain = {
            add_loyalists = {
			    value = medium_radicals
			    pop_type = officers
		    }
            add_modifier = {
                name = cvlm_modifier_country_bloody_suppression_cover
                months = short_modifier_time
            }
		    # pleased
            every_interest_group = {
                limit = { cvlm_is_pro_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = short_modifier_time
                }
            }
            # angered
            every_interest_group = {
                limit = { cvlm_is_anti_colonialism_ig = yes }
                add_modifier = {
				    name = cvlm_modifier_ig_angered
				    months = short_modifier_time
                }
            }
		}
        # subject: modifiers, liberty desire, lobby appeasement
        scope:colonial_subject = { 
            add_liberty_desire = 10
		}
        scope:anti_overlord_lobby = { 
            change_appeasement = { amount = -2 factor = appeasement_lobby_loss } 
            every_lobby_member = {
                add_modifier = {
                    name = cvlm_modifier_ig_bloody_suppression
                    months = short_modifier_time
                }
            }
        }
        # lost population
        scope:colonial_subject.capital = {
            kill_population_percent_in_state = { percent = 0.001 interest_group = scope:anti_overlord_ig }
		}
    }
}

# Simmering Conflict - Illusive Gentleman
cvlm_establish.110 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.110.t
	desc = cvlm_establish.110.d
	flavor = cvlm_establish.110.f

	gui_window = event_window_1char_propaganda

	left_icon = scope:colonial_garrison_officer

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_military.dds"

    immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        # create_character
        scope:colonial_subject = {
            scope:colonial_suzerain = { ordered_primary_culture = { save_temporary_scope_as = colonial_suzerain_culture } }
            create_character = {
                template = cvlm_illusive_gentleman
                culture = scope:colonial_suzerain_culture
                interest_group = ig_armed_forces
                save_scope_as = colonial_garrison_officer
            }
        }
    }

	option = {
		name = cvlm_establish.110.1
        cvlm_establish_tolerance_increase = yes
        default_option = yes
        # go home
        scope:colonial_garrison_officer = {
            hidden_effect = { free_character_from_void = yes }
			cvlm_suzerain_recall_character_effect = yes
		}
        # suzerain
		scope:colonial_suzerain = {
            ig:ig_armed_forces = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased
				    months = short_modifier_time
			    }
		    }
		}
        # subject
        scope:anti_overlord_lobby = { 
            every_lobby_member = {
                add_modifier = {
                    name = cvlm_modifier_ig_bloody_suppression
                    months = short_modifier_time
                }
                leader = { 
                    if = {
                        limit = { is_ruler = no }
                        kill_character = yes 
                    }
                }
            }
        }
   	}

    option = {
		name = cvlm_establish.110.2
		cvlm_establish_tolerance_increase = yes
        # suzerain
		scope:colonial_suzerain = {
            ig:ig_armed_forces = {
			    add_modifier = {
				    name = cvlm_modifier_ig_pleased_less
				    months = short_modifier_time
			    }
		    }
            add_modifier = {
                name = cvlm_modifier_country_secret_police
                months = short_modifier_time
            }
            hidden_effect = { scope:colonial_garrison_officer = { kill_character = { value = yes hidden = yes } } }
		}
        # subject
        scope:anti_overlord_lobby = { 
            every_lobby_member = {
                add_modifier = {
                    name = cvlm_modifier_ig_bloody_suppression
                    months = short_modifier_time
                }
                leader = { 
                    if = {
                        limit = { is_ruler = no }
                        kill_character = yes 
                    }
                }
            }
        }
   	}

    option = {
		name = cvlm_establish.110.3
        highlighted_option = yes
        show_as_unavailable = { always = yes }
		trigger = {
            has_law = law_type:law_secret_police
            custom_tooltip = {
                text = cvlm_establish.110.3.tooltip
                always = no
            }
        }
   	}
}

# Simmering Conflict - Smooth-Talking Charmer
cvlm_establish.115 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.115.t
	desc = cvlm_establish.115.d
	flavor = cvlm_establish.115.f

	gui_window = event_window_1char_propaganda

	left_icon = scope:colonial_garrison_officer

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_military.dds"

    immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        # create character
        scope:colonial_subject = {
            scope:colonial_suzerain = {
                ordered_primary_culture = { save_temporary_scope_as = colonial_suzerain_culture }
                random_interest_group = {
                    limit = {
                        OR = {
                            is_interest_group_type = ig_landowners
                            is_interest_group_type = ig_intelligentsia
                            is_interest_group_type = ig_petty_bourgeoisie
                            is_interest_group_type = ig_industrialists
                        }
                    }
                    save_temporary_scope_as = colonial_garrison_officer_ig_suzerain
                }
            }
            random_interest_group = {
				limit = { is_same_interest_group_type = scope:colonial_garrison_officer_ig_suzerain }
				save_temporary_scope_as = colonial_garrison_officer_ig_subject
			}
            create_character = {
                template = cvlm_smooth_talking_charmer
                culture = scope:colonial_suzerain_culture
                interest_group = scope:colonial_garrison_officer_ig_subject
                save_scope_as = colonial_garrison_officer
            }
        }
    }

	option = {
		name = cvlm_establish.115.1
        cvlm_establish_tolerance_increase = yes
        scope:colonial_garrison_officer = {
            hidden_effect = { free_character_from_void = yes }
			cvlm_suzerain_recall_character_effect = yes
		}
        scope:colonial_garrison_officer_ig_suzerain = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased
                months = short_modifier_time
            }
        }
   	}

    option = {
		name = cvlm_establish.115.2
		cvlm_establish_tolerance_increase = yes
        scope:colonial_garrison_officer_ig_suzerain = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased_less
                months = short_modifier_time
            }
        }
        ig:ig_armed_forces = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased_less
                months = short_modifier_time
            }
        }
        hidden_effect = { scope:colonial_garrison_officer = { kill_character = { value = yes hidden = yes } } }
        default_option = yes
   	}
}

# Simmering Conflict - Unpopular Figurehead
cvlm_establish.120 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_subject
	duration = 2

	title = cvlm_establish.120.t
	desc = cvlm_establish.120.d
	flavor = cvlm_establish.120.f

	gui_window = event_window_1char_propaganda

	left_icon = scope:colonial_garrison_officer

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_military.dds"

    immediate = {
        cvlm_event_bug_detect_suzerain = yes
        cvlm_establish_lobby_set_effect = yes 
        # create character
        scope:colonial_subject = {
            scope:colonial_suzerain = {
                ordered_primary_culture = { save_temporary_scope_as = colonial_suzerain_culture }
                random_interest_group = {
                    limit = {
                        OR = {
                            is_interest_group_type = ig_landowners
                            is_interest_group_type = ig_intelligentsia
                            is_interest_group_type = ig_petty_bourgeoisie
                            is_interest_group_type = ig_industrialists
                        }
                    }
                    save_temporary_scope_as = colonial_garrison_officer_ig_suzerain
                }
            }
            random_interest_group = {
				limit = { is_same_interest_group_type = scope:colonial_garrison_officer_ig_suzerain }
				save_temporary_scope_as = colonial_garrison_officer_ig_subject
			}
            create_character = {
                template = cvlm_unpopular_figurehead
                culture = scope:colonial_suzerain_culture
                interest_group = scope:colonial_garrison_officer_ig_subject
                save_scope_as = colonial_garrison_officer
            }
        }
    }

	option = {
		name = cvlm_establish.120.1
        cvlm_establish_tolerance_decrease = yes
        ig:ig_armed_forces = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased
                months = short_modifier_time
            }
        }
        scope:colonial_garrison_officer_ig_suzerain = {
            add_modifier = {
                name = cvlm_modifier_ig_angered
                months = short_modifier_time
            }
        }
        hidden_effect = { scope:colonial_garrison_officer = { kill_character = { value = yes hidden = yes } } }
   	}

    option = {
		name = cvlm_establish.120.2
		cvlm_establish_tolerance_decrease = yes
        scope:colonial_garrison_officer_ig_suzerain = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased_less
                months = short_modifier_time
            }
        }
        ig:ig_armed_forces = {
            add_modifier = {
                name = cvlm_modifier_ig_angered_less
                months = short_modifier_time
            }
        }
        hidden_effect = { scope:colonial_garrison_officer = { kill_character = { value = yes hidden = yes } } }
        default_option = yes
   	}

    option = {
		name = cvlm_establish.120.3
		cvlm_establish_tolerance_decrease = yes
        scope:colonial_garrison_officer = {
            hidden_effect = { free_character_from_void = yes }
			cvlm_suzerain_recall_character_effect = yes
		}
        scope:colonial_garrison_officer_ig_suzerain = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased
                months = short_modifier_time
            }
        }
        ig:ig_armed_forces = {
            add_modifier = {
                name = cvlm_modifier_ig_angered
                months = short_modifier_time
            }
        }
   	}
}

# The Rightful Governor
cvlm_establish.200 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_suzerain
	duration = 2

	title = cvlm_establish.200.t
	desc = cvlm_establish.200.d
	flavor = cvlm_establish.200.f

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	event_image = {
		video = "southamerica_aristocrats"
	}

	icon = "gfx/interface/icons/generic_icons/mandate.dds"

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        if = {
            limit = { NOT = { exists = scope:colonial_subject_culture } }
            scope:colonial_subject = {
                ordered_primary_culture = {
                    limit = { is_primary_culture_of = scope:colonial_subject }
                    save_scope_as = colonial_subject_culture
                }
            }
        }
        # lobby
        cvlm_establish_lobby_set_effect = yes
        scope:colonial_subject = {
            ordered_interest_group = {
                limit = { 
                    any_political_lobby = {
                        OR = {
                            is_political_lobby_type = lobby_pro_overlord
                            is_political_lobby_type = lobby_pro_country
                        }
                        target = { scope:colonial_suzerain ?= THIS }
                    }
                }
                order_by = ig_clout
                leader = { save_scope_as = lobby_leader }
            }
        }
	}

	option = {
		name = cvlm_establish.200.1
        if = {
            limit = { has_game_rule = cvlm_flavoured_flatterer_on }
            custom_tooltip = {
                text = cvlm_establish.200.1.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = 1
                }
            }
        }
        else = {
            custom_tooltip = {
                text = cvlm_establish.200.1.tooltip
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = 1
                }
            }
        }
		ai_chance = {
			base = 20
		}
        default_option = yes
   	}

	option = {
		name = cvlm_establish.200.2
        highlighted_option = yes
        show_as_unavailable = { always = yes }
		trigger = { has_law = law_type:law_monarchy }
        add_loyalists = {
            value = medium_radicals
            pop_type = aristocrats
        }
        random_list = {
            99 = {
                trigger_event = { id = cvlm_establish.205 days = 7 }
            }
            1 = {
            }
        }
        if = {
            limit = { has_game_rule = cvlm_flavoured_flatterer_on }
            custom_tooltip = {
                text = cvlm_establish.200.2.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = -1
                }
            }
        }
        else = {
            custom_tooltip = {
                text = cvlm_establish.200.2.tooltip
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = -1
                }
            }
        }
   	}

	option = {
		name = cvlm_establish.200.3
        highlighted_option = yes
        show_as_unavailable = { always = yes }
		trigger = {
            custom_tooltip = {
                text = cvlm_establish.20.2.outcome.trigger
                trigger_if = {
                    limit = { exists = var:cvlm_establish_option_culture_var }
                    NOT = { var:cvlm_establish_option_culture_var = -1 }
                }
                scope:colonial_subject_culture = {
                    is_primary_culture_of = scope:colonial_subject
                }
            }
        }
        cvlm_establish_tolerance_increase = yes
        if = {
            limit = { has_game_rule = cvlm_flavoured_flatterer_on }
            custom_tooltip = {
                text = cvlm_establish.200.3.tooltip.flatterer
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = -2
                }
            }
        }
        else = {
            custom_tooltip = {
                text = cvlm_establish.200.3.tooltip
                set_variable = {
                    name = cvlm_establish_option_governor_var
                    value = -2
                }
            }
        }
		ai_chance = {
			base = 0
		}
   	}

	option = {
		name = cvlm_establish.200.4
        custom_tooltip = {
            text = cvlm_establish.200.4.tooltip
            set_variable = {
                name = cvlm_establish_option_governor_var
                value = -2
            }
            scope:lobby_leader = { add_modifier = cvlm_modifier_character_governor_candidate }
        }
        scope:pro_overlord_lobby = { change_appeasement = { amount = 2 factor = appeasement_lobby_gain } }
		ai_chance = {
			base = 10
		}
   	}

	# option = {
	# 	name = cvlm_establish.200.0
    #     highlighted_option = yes
    #     show_as_unavailable = { has_game_rule = cvlm_flavoured_flatterer_on }
    #     trigger = { 
    #         custom_tooltip = {
    #             text = cvlm_establish.200.0.tooltip
    #             always = no 
    #         }
    #     }
    #     custom_tooltip = cvlm_establish.200.0.info
   	# }
}

cvlm_establish.201 = {
	type = country_event
	hidden = yes

    immediate = {
        random_scope_character ={
            limit = { has_modifier = cvlm_modifier_character_governor_candidate_mark }
            if = {
                limit = { is_ruler = no }
                set_character_as_ruler = yes
            }
            remove_modifier = cvlm_modifier_character_governor_candidate_mark
        }
	}
}

# There Can Be Only One
cvlm_establish.205 = {
	type = country_event
    dlc = dlc_civilization_mission
	placement = scope:colonial_suzerain
    duration = 1

	title = cvlm_establish.205.t
	desc = cvlm_establish.205.d
	flavor = cvlm_establish.205.f

	gui_window = event_window_2char

	left_icon = scope:cvlm_modifier_character_governor_candidate_1
	right_icon = scope:cvlm_modifier_character_governor_candidate_2

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/2Characters"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

    # it bothers this one that, characters must have to hold a "position" to avoid being removed from the game
    # it seems that saving the candicate for some time before sending him to the subject is not possible, unless you grant him a "position" (General/IG Leader...)
    # currently, this one moves the candidate to the subject as an ig leader first

	immediate = {
        cvlm_event_bug_detect_suzerain = yes
        # pick ig for character 1
        random_interest_group = {
            limit = {
                OR = {
                    is_interest_group_type = ig_landowners
                    is_interest_group_type = ig_armed_forces
                    is_interest_group_type = ig_petty_bourgeoisie
                    is_interest_group_type = ig_intelligentsia
                }
            }
            save_scope_as = cvlm_modifier_character_governor_candidate_1_ig
        }
        # pick ig for character 2
        random_interest_group = {
            limit = {
                OR = {
                    is_interest_group_type = ig_landowners
                    is_interest_group_type = ig_armed_forces
                    is_interest_group_type = ig_petty_bourgeoisie
                    is_interest_group_type = ig_intelligentsia
                }
                NOT = { is_same_interest_group_type = scope:cvlm_modifier_character_governor_candidate_1_ig }
            }
            save_scope_as = cvlm_modifier_character_governor_candidate_2_ig
        }
        # create characters
        create_character = {
            noble = yes
            is_general = yes
            interest_group = scope:cvlm_modifier_character_governor_candidate_1_ig
            on_created = {
                place_character_in_void = 3
                #add_character_role = politician
            }
            save_scope_as = cvlm_modifier_character_governor_candidate_1
        }
        create_character = {
            noble = yes
            is_general = yes
            interest_group = scope:cvlm_modifier_character_governor_candidate_2_ig
            on_created = {
                place_character_in_void = 3
                #add_character_role = politician
            }
            save_scope_as = cvlm_modifier_character_governor_candidate_2
        }
        # clean modifiers - for testing purposes
        scope:colonial_suzerain = {
            every_character = {
                limit = { has_modifier = cvlm_modifier_character_governor_candidate }
                remove_modifier = cvlm_modifier_character_governor_candidate
            }
        }
        scope:colonial_subject = {
            every_character = {
                limit = { has_modifier = cvlm_modifier_character_governor_candidate }
                remove_modifier = cvlm_modifier_character_governor_candidate
            }
        }
	}

	option = {
		name = cvlm_establish.205.1
        # tooltip
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = cvlm_establish.205.1.tooltip.flatterer
		}
		else = {
		    custom_tooltip = cvlm_establish.205.1.tooltip
		}
        # transfer
        hidden_effect = {
            scope:cvlm_modifier_character_governor_candidate_1 = {
                free_character_from_void = yes
                transfer_character = scope:colonial_subject
                set_as_interest_group_leader = yes
                add_modifier = { name = cvlm_modifier_character_governor_candidate }
                remove_character_role = general
            }
            scope:cvlm_modifier_character_governor_candidate_2 = {
                kill_character = { value = yes hidden = yes }
            }
        }
        # ig
        scope:cvlm_modifier_character_governor_candidate_1_ig = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased_less
                months = short_modifier_time
            }
        }
        scope:cvlm_modifier_character_governor_candidate_2_ig = {
            add_modifier = {
                name = cvlm_modifier_ig_angered_less
                months = short_modifier_time
            }
        }
   	}

	option = {
		name = cvlm_establish.205.2
        # tooltip
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = cvlm_establish.205.2.tooltip.flatterer
		}
		else = {
		    custom_tooltip = cvlm_establish.205.1.tooltip
		}
        # transfer
        hidden_effect = {
            scope:cvlm_modifier_character_governor_candidate_1 = {
                kill_character = { value = yes hidden = yes }
            }
            scope:cvlm_modifier_character_governor_candidate_2 = {
                free_character_from_void = yes
                transfer_character = scope:colonial_subject
                set_as_interest_group_leader = yes
                add_modifier = { name = cvlm_modifier_character_governor_candidate }
                remove_character_role = general
            }
        }
        # ig
        scope:cvlm_modifier_character_governor_candidate_1_ig = {
            add_modifier = {
                name = cvlm_modifier_ig_angered_less
                months = short_modifier_time
            }
        }
        scope:cvlm_modifier_character_governor_candidate_2_ig = {
            add_modifier = {
                name = cvlm_modifier_ig_pleased_less
                months = short_modifier_time
            }
        }
   	}

	option = {
		name = cvlm_establish.205.3
        highlighted_option = yes
        show_as_unavailable = { always = yes }
		trigger = {
            custom_tooltip = {
                text = cvlm_establish.205.3.tooltip
                NOT = { has_variable = duels_banned }
            }
        }
        # Vanilla event "The Duel" ( character_events.3 ) has a more complex system, this one would go in a simple way
        random_list = {
            50 = {
                # character 1 win
                custom_tooltip = {
                    text = cvlm_establish.205.1.tooltip
                    scope:cvlm_modifier_character_governor_candidate_1 = { 
                        free_character_from_void = yes
                        transfer_character = scope:colonial_subject
                        set_as_interest_group_leader = yes
                        add_modifier = { name = cvlm_modifier_character_governor_candidate }
                        remove_character_role = general
                    }
                    scope:cvlm_modifier_character_governor_candidate_2 = {
                        kill_character = { value = yes hidden = yes }
                    }
                }
            }
            50 = {
                # character 2 win
                custom_tooltip = {
                    text = cvlm_establish.205.2.tooltip
                    scope:cvlm_modifier_character_governor_candidate_1 = {
                        kill_character = { value = yes hidden = yes }
                    }
                    scope:cvlm_modifier_character_governor_candidate_2 = { 
                        free_character_from_void = yes
                        transfer_character = scope:colonial_subject
                        set_as_interest_group_leader = yes
                        add_modifier = { name = cvlm_modifier_character_governor_candidate }
                        remove_character_role = general
                    }
                }
            }
        }
   	}

	option = {
		name = cvlm_establish.205.4
		# displaying modifiers for fun - the characters will be removed
		scope:cvlm_modifier_character_governor_candidate_1 = {
			add_modifier = { name = tarnished_honor_modifier }
		}
		scope:cvlm_modifier_character_governor_candidate_2 = {
			add_modifier = { name = tarnished_honor_modifier }
		}
        # tooltip
		if = {
		    limit = { has_game_rule = cvlm_flavoured_flatterer_on }
		    custom_tooltip = cvlm_establish.205.4.tooltip.flatterer
		}
		else = {
		    custom_tooltip = cvlm_establish.205.4.tooltip
		}
        hidden_effect = {
            scope:cvlm_modifier_character_governor_candidate_1 = { kill_character = { value = yes hidden = yes } }
            scope:cvlm_modifier_character_governor_candidate_2 = { kill_character = { value = yes hidden = yes } }
        }
   	}
}

# Out of sight, out of mind